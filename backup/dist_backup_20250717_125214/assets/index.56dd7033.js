import{_ as P,d as T,u as U,r as d,c as f,o as K,b as o,e,y as x,z as F,F as v,g,A as L,t as i,f as y,x as B,p as G,v as a,l as C}from"./index.14f46279.js";const O={class:"p-6 bg-gray-50 min-h-screen"},H={class:"max-w-7xl mx-auto"},J={class:"bg-white p-6 rounded-lg shadow-sm mb-8"},Q={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},W=["value"],X=["disabled"],Y=["value"],Z={class:"mt-6 flex space-x-4"},ee=["disabled"],te=["disabled"],ne={key:0,class:"bg-white rounded-lg shadow-sm mb-8"},se={class:"px-6 py-4 border-b border-gray-200"},ue={class:"text-lg font-semibold text-gray-900"},oe={class:"p-6"},ae={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},ie={class:"bg-gray-50 p-4 rounded-lg"},re={class:"text-sm text-gray-900"},le={class:"bg-gray-50 p-4 rounded-lg"},ce={class:"text-sm text-gray-900"},de={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},_e={key:0},me={class:"bg-gray-50 p-4 rounded-lg"},be={class:"text-sm text-gray-900 whitespace-pre-wrap"},pe={key:1},ve={class:"bg-gray-50 p-4 rounded-lg"},ge={class:"text-sm text-gray-900 whitespace-pre-wrap"},ye={key:1},he={class:"space-y-3"},fe={class:"flex-1"},xe={class:"text-sm font-medium text-gray-900"},Ee={class:"text-xs text-gray-500"},we={key:0,class:"text-xs text-gray-600 mt-1"},ke={class:"ml-4"},Fe=["href"],Be={key:2},Ce={class:"bg-white rounded-lg shadow-sm"},De={class:"p-6"},Ae={key:0,class:"text-center py-8 text-gray-500"},je={key:1,class:"text-center py-8 text-gray-500"},Me={key:2,class:"space-y-6"},Se={class:"text-md font-semibold text-gray-800 mb-3 flex items-center"},$e={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},ze=["onClick"],Ve={class:"flex items-center justify-between"},Re={class:"flex-1"},qe={class:"font-medium text-gray-900 text-sm"},Ie={class:"text-xs text-gray-600 mt-1"},Ne={class:"ml-3"},Pe=T({__name:"index",setup(Te){const h=G(),D=U(),p=d([]),E=d(!0),_=d(""),l=d(null),c=d(new Date().toISOString().slice(0,7)),r=d(null),m=d([]),A=f(()=>[...new Set(p.value.map(t=>t.module_category==="\u5357\u534E"?"\u5357\u534E\u516C\u53F8":t.module_category))].sort()),j=f(()=>_.value?_.value==="\u5357\u534E\u516C\u53F8"?p.value.filter(s=>s.module_category==="\u5357\u534E\u516C\u53F8"||s.module_category==="\u5357\u534E"):p.value.filter(s=>s.module_category===_.value):[]),w=f(()=>{const s=new Map;p.value.forEach(n=>{let u=n.module_category;u==="\u5357\u534E"&&(u="\u5357\u534E\u516C\u53F8"),s.has(u)||s.set(u,[]),s.get(u).push(n)});const t=[];return s.forEach((n,u)=>{t.push({name:u,modules:n.sort((b,N)=>b.module_name.localeCompare(N.module_name))})}),t.sort((n,u)=>n.name.localeCompare(u.name))}),M=async()=>{var s;try{const t=((s=D.userInfo)==null?void 0:s.id)||1,n=await fetch(`http://47.111.95.19:3000/permissions/user/${t}`);if(!n.ok)throw new Error("\u83B7\u53D6\u7528\u6237\u6743\u9650\u5931\u8D25");const u=await n.json();u.success&&(p.value=u.data.accessible_modules||[])}catch(t){console.error("\u83B7\u53D6\u7528\u6237\u6A21\u5757\u5931\u8D25:",t)}finally{E.value=!1}},S=()=>{l.value=null},$=()=>{r.value=null,m.value=[]},z=()=>{r.value=null,m.value=[]},V=async()=>{if(!(!l.value||!c.value))try{const s=await fetch(`http://47.111.95.19:3000/forms/submission/${l.value.id}/${c.value}`);if(s.ok){const n=await s.json();n.success&&(r.value=n.data)}else{r.value=null,m.value=[],alert(`${l.value.module_name} \u5728 ${c.value} \u671F\u95F4\u6682\u65E0\u63D0\u4EA4\u8BB0\u5F55`);return}const t=await fetch(`http://47.111.95.19:3000/files/attachments/${l.value.id}/${c.value}`);if(t.ok){const n=await t.json();n.success&&(m.value=n.data||[])}}catch(s){console.error("\u52A0\u8F7D\u63D0\u4EA4\u8BE6\u60C5\u5931\u8D25:",s),alert("\u52A0\u8F7D\u63D0\u4EA4\u8BE6\u60C5\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}},R=s=>{if(s===0)return"0 Bytes";const t=1024,n=["Bytes","KB","MB","GB"],u=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,u)).toFixed(2))+" "+n[u]},q=s=>new Date(s).toLocaleString("zh-CN"),I=()=>{l.value&&k(l.value)},k=s=>{const t={"/example/CostCenterStructure":"/cost-center-structure","/example/BalanceSheet":"/example","/example/CashFlowStatement":"/cashflow","/example/IncomeStatement":"/incomestatement","/example/ProductionValue":"/production-value","/example/ProjectTracking":"/projecttracking"},u={balance_sheet:"/example",cash_flow:"/cashflow",income_statement:"/incomestatement",cost_center_structure:"/cost-center-structure-quality",production_value:"/production-value",project_tracking:"/projecttracking",business_income_structure:"/business-income-structure",main_business_income:"/main-business-income",order_to_income:"/order-to-income",stock_order_to_income:"/stock-order-to-income",non_main_business:"/non-main-business",business_contribution:"/business-contribution",business_profit_margin:"/business-profit-margin",net_profit_structure:"/net-profit-structure",main_business_net_profit:"/main-business-net-profit",non_main_business_net_profit:"/non-main-business-net-profit",receipt_structure:"/receipt-structure",accounts_receivable:"/accounts-receivable",overdue_receivables:"/overdue-receivables",bad_debt_provision:"/bad-debt-provision",new_orders:"/new-order",bidding_status:"/bidding-status",bid_fulfillment:"/bid-fulfillment",inventory_structure:"/inventory-structure",inventory_in_progress:"/inventory-in-progress",contract_inventory:"/contract-inventory",main_business_cost:"/main-business-cost",cost_estimation:"/cost-estimation",inventory_stock:"/inventory-stock",production_plan_execution:"/production-plan-execution",production_execution_analysis:"/production-execution-analysis",department_cost_center:"/department-cost-center",department_cost_input:"/department-cost-input",major_investment_analysis:"/major-investment-analysis",budget_execution:"/budget-execution",nanhua_new_orders:"/nanhua/new-order-structure",nanhua_project_tracking:"/nanhua/project-tracking",nanhua_bidding_status:"/nanhua/bidding-status",nanhua_business_income:"/nanhua/business-income",nanhua_order_to_income:"/nanhua/order-to-income",nanhua_stock_order_to_income:"/nanhua/stock-order-to-income",nanhua_main_business_cost:"/nanhua/main-business-cost",nanhua_cost_provision:"/nanhua/cost-provision",nanhua_cost_center_structure:"/nanhua/cost-center-structure",nanhua_department_cost_center_actual:"/nanhua/department-cost-center-actual",nanhua_department_cost_input:"/nanhua/department-cost-input",nanhua_contract_inventory:"/nanhua/contract-inventory",nanhua_non_main_business:"/nanhua/non-main-business",nanhua_inventory_structure:"/nanhua/inventory-structure",nanhua_bid_fulfillment:"/nanhua/bid-fulfillment",nanhua_business_contribution_with_self_built:"/nanhua/business-contribution-with-self-built",nanhua_business_profit_margin_with_self_built:"/nanhua/business-profit-margin-with-self-built",nanhua_main_business_net_profit_contribution:"/nanhua/main-business-net-profit-contribution",nanhua_non_main_business_net_profit_contribution:"/nanhua/non-main-business-net-profit-contribution",nanhua_main_business_net_profit:"/nanhua/main-business-net-profit-contribution",nanhua_non_main_business_net_profit:"/nanhua/non-main-business-net-profit-contribution",nanhua_receipt_structure:"/nanhua/receipt-structure",nanhua_contract_inventory_evaluation:"/nanhua/contract-inventory-evaluation",department_cost_center_actual:"/nanhua/department-cost-center-actual",nanhua_analysis_appendix:"/nanhua/analysis-appendix",nanhua_overdue_receivables:"/nanhua/overdue-receivables",nanhua_bad_debt_provision:"/nanhua/bad-debt-provision",nanhua_self_construction_analysis:"/nanhua/self-construction-analysis",nanhua_construction_plan_execution:"/nanhua/construction-plan-execution",nanhua_construction_execution_status:"/nanhua/construction-execution-status",nanhua_major_investment:"/nanhua/major-investment",tuoyuan_new_order_structure:"/tuoyuan/new-order-structure",tuoyuan_project_tracking:"/tuoyuan/project-tracking",tuoyuan_bidding_status:"/tuoyuan/bidding-status",main_business_income_breakdown:"/tuoyuan/main-business-income-breakdown",tuoyuan_order_to_income:"/tuoyuan/order-to-income",tuoyuan_stock_order_to_income:"/tuoyuan/stock-order-to-income",tuoyuan_non_main_business:"/tuoyuan/non-main-business",tuoyuan_inventory_structure:"/tuoyuan/inventory-structure",tuoyuan_bid_fulfillment:"/tuoyuan/bid-fulfillment",tuoyuan_inventory_in_progress:"/tuoyuan/inventory-in-progress",tuoyuan_inventory_status:"/tuoyuan/inventory-status",tuoyuan_main_business_cost_structure_quality:"/tuoyuan/main-business-cost-structure-quality",tuoyuan_cost_estimation:"/tuoyuan/cost-estimation",tuoyuan_cost_center_profit_loss:"/tuoyuan/cost-center-profit-loss",tuoyuan_main_business_contribution_rate:"/tuoyuan/main-business-contribution-rate",tuoyuan_main_business_profit_margin:"/tuoyuan/main-business-profit-margin",tuoyuan_main_business_net_profit_contribution:"/tuoyuan/main-business-net-profit-contribution",payment_structure_quality:"/tuoyuan/payment-structure-quality",tuoyuan_accounts_receivable:"/tuoyuan/accounts-receivable",tuoyuan_overdue_receivables:"/tuoyuan/overdue-receivables",tuoyuan_bad_debt_provision:"/tuoyuan/bad-debt-provision",tuoyuan_construction_plan_execution:"/tuoyuan/construction-plan-execution",tuoyuan_major_investment:"/tuoyuan/major-investment",tuoyuan_production_value_self_construction:"/tuoyuan/production-value-self-construction",tuoyuan_construction_execution_status:"/tuoyuan/construction-execution-status"}[s.module_key];if(u){h.push(u);return}if(s.route_path&&s.route_path!=="/"){const b=t[s.route_path]||s.route_path;h.push(b)}else{const b=s.module_key.replace(/_/g,"-");h.push(`/${b}`)}};return K(()=>{M()}),(s,t)=>(a(),o("div",O,[e("div",H,[t[17]||(t[17]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"\u5BA1\u9605"),e("p",{class:"text-gray-600 mt-2"},"\u9009\u62E9\u9700\u8981\u67E5\u770B\u7684\u8868\u5355\u6A21\u5757")],-1)),e("div",J,[e("div",Q,[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"\u9009\u62E9\u5206\u7C7B",-1)),x(e("select",{"onUpdate:modelValue":t[0]||(t[0]=n=>_.value=n),onChange:S,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[t[3]||(t[3]=e("option",{value:""},"\u8BF7\u9009\u62E9\u5206\u7C7B",-1)),(a(!0),o(v,null,g(A.value,n=>(a(),o("option",{key:n,value:n},i(n),9,W))),128))],544),[[F,_.value]])]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"\u9009\u62E9\u8868\u5355",-1)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=n=>l.value=n),onChange:$,disabled:!_.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100"},[t[5]||(t[5]=e("option",{value:""},"\u8BF7\u9009\u62E9\u8868\u5355",-1)),(a(!0),o(v,null,g(j.value,n=>(a(),o("option",{key:n.id,value:n},i(n.module_name),9,Y))),128))],40,X),[[F,l.value]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"\u9009\u62E9\u671F\u95F4",-1)),x(e("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>c.value=n),type:"month",onChange:z,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},null,544),[[L,c.value]])])]),e("div",Z,[e("button",{onClick:I,disabled:!l.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"}," \u67E5\u770B\u8868\u5355 ",8,ee),e("button",{onClick:V,disabled:!l.value||!c.value,class:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"}," \u67E5\u770B\u63D0\u4EA4\u8BE6\u60C5 ",8,te)])]),r.value?(a(),o("div",ne,[e("div",se,[e("h3",ue,i(r.value.module_name)+" - "+i(c.value)+" \u63D0\u4EA4\u8BE6\u60C5 ",1)]),e("div",oe,[e("div",ae,[t[10]||(t[10]=e("div",{class:"bg-gray-50 p-4 rounded-lg"},[e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"\u63D0\u4EA4\u72B6\u6001"),e("span",{class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800"}," \u5DF2\u63D0\u4EA4 ")],-1)),e("div",ie,[t[8]||(t[8]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"\u6700\u540E\u63D0\u4EA4\u4EBA",-1)),e("p",re,i(r.value.last_submitted_by_name),1)]),e("div",le,[t[9]||(t[9]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"\u63D0\u4EA4\u6B21\u6570",-1)),e("p",ce,i(r.value.submission_count)+" \u6B21",1)])]),r.value.remarks||r.value.suggestions?(a(),o("div",de,[r.value.remarks?(a(),o("div",_e,[t[11]||(t[11]=e("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"\u5907\u6CE8\u4FE1\u606F",-1)),e("div",me,[e("p",be,i(r.value.remarks),1)])])):y("",!0),r.value.suggestions?(a(),o("div",pe,[t[12]||(t[12]=e("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"\u5EFA\u8BAE\u4FE1\u606F",-1)),e("div",ve,[e("p",ge,i(r.value.suggestions),1)])])):y("",!0)])):y("",!0),m.value.length>0?(a(),o("div",ye,[t[13]||(t[13]=e("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"\u9644\u4EF6\u6587\u4EF6",-1)),e("div",he,[(a(!0),o(v,null,g(m.value,n=>(a(),o("div",{key:n.id,class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},[e("div",fe,[e("p",xe,i(n.original_name),1),e("p",Ee," \u5927\u5C0F: "+i(R(n.file_size))+" | \u4E0A\u4F20\u65F6\u95F4: "+i(q(n.uploaded_at))+" | \u4E0A\u4F20\u4EBA: "+i(n.uploaded_by),1),n.description?(a(),o("p",we,i(n.description),1)):y("",!0)]),e("div",ke,[e("a",{href:`http://47.111.95.19:3000/files/download/${n.id}`,target:"_blank",class:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700"}," \u4E0B\u8F7D ",8,Fe)])]))),128))])])):(a(),o("div",Be,t[14]||(t[14]=[e("h4",{class:"text-sm font-medium text-gray-700 mb-3"},"\u9644\u4EF6\u6587\u4EF6",-1),e("div",{class:"bg-gray-50 p-4 rounded-lg text-center"},[e("p",{class:"text-sm text-gray-500"},"\u6682\u65E0\u9644\u4EF6")],-1)])))])])):y("",!0),e("div",Ce,[t[16]||(t[16]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"\u53EF\u8BBF\u95EE\u7684\u8868\u5355\u5217\u8868")],-1)),e("div",De,[E.value?(a(),o("div",Ae,t[15]||(t[15]=[e("div",{class:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"},null,-1),B(" \u52A0\u8F7D\u4E2D... ")]))):w.value.length===0?(a(),o("div",je," \u6682\u65E0\u53EF\u8BBF\u95EE\u7684\u8868\u5355 ")):(a(),o("div",Me,[(a(!0),o(v,null,g(w.value,n=>(a(),o("div",{key:n.name,class:"border rounded-lg p-4"},[e("h4",Se,[e("span",{class:C(["w-3 h-3 rounded-full mr-2",{"bg-blue-500":n.name==="\u8D22\u52A1","bg-green-500":n.name==="\u8425\u9500","bg-yellow-500":n.name==="\u751F\u4EA7","bg-purple-500":n.name==="\u4F01\u7BA1","bg-red-500":n.name==="\u5357\u534E\u516C\u53F8","bg-orange-500":n.name==="\u62D3\u6E90\u516C\u53F8"}])},null,2),B(" "+i(n.name)+" ("+i(n.modules.length)+" \u4E2A\u6A21\u5757) ",1)]),e("div",$e,[(a(!0),o(v,null,g(n.modules,u=>(a(),o("div",{key:u.id,class:"p-3 border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-sm transition-all cursor-pointer",onClick:b=>k(u)},[e("div",Ve,[e("div",Re,[e("h5",qe,i(u.module_name),1),e("p",Ie,i(u.description),1)]),e("div",Ne,[e("span",{class:C(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",{"bg-green-100 text-green-800":u.permission_type==="write","bg-blue-100 text-blue-800":u.permission_type==="read"}])},i(u.permission_type==="write"?"\u53EF\u7F16\u8F91":"\u53EA\u8BFB"),3)])])],8,ze))),128))])]))),128))]))])])])]))}});var Ke=P(Pe,[["__scopeId","data-v-23454f0a"]]);export{Ke as default};
