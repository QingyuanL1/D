import{d as C,u as w,r as m,D as E,b as n,e as u,x as i,k as F,w as D,m as B,y as p,z as h,A as f,t as y,f as A,p as k,G as S,q as V,v as a,s as c}from"./index.a9b1a8ee.js";const z={class:"min-h-screen flex items-center justify-center bg-gray-50"},N={class:"max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow-lg"},_={class:"mt-2 text-center text-sm text-gray-600"},M={class:"rounded-md shadow-sm -space-y-px"},T={key:0,class:"text-red-500 text-sm text-center"},U=["disabled"],j={class:"absolute left-0 inset-y-0 flex items-center pl-3"},q={key:0,class:"h-5 w-5 text-blue-500 group-hover:text-blue-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},O={key:1,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},P=C({__name:"index",setup(I){const v=k(),x=S(),g=w(),r=m(!1),l=m(""),t=E({company:"",username:"",password:""}),b=async()=>{try{l.value="",r.value=!0;const o=await fetch("http://47.111.95.19:3000/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const s=await o.json();throw new Error(s.error||"\u767B\u5F55\u5931\u8D25")}const e=await o.json();if(!e.success)throw new Error(e.error||"\u767B\u5F55\u5931\u8D25");localStorage.setItem("token",e.data.token),c.set("ACCESS_TOKEN",e.data.token),localStorage.setItem("selectedCompany",t.company),c.set("SELECTED_COMPANY",t.company),c.set("USER_INFO",e.data.user),g.setUserInfo(e.data.user);const d=x.query.redirect||"/";v.push(d)}catch(o){console.error("\u767B\u5F55\u5931\u8D25:",o),l.value=o instanceof Error?o.message:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7528\u6237\u540D\u548C\u5BC6\u7801"}finally{r.value=!1}};return(o,e)=>{const d=V("router-link");return a(),n("div",z,[u("div",N,[u("div",null,[e[5]||(e[5]=u("div",{class:"mt-6 text-center font-extrabold text-gray-900"},[u("div",{class:"text-3xl"},"\u5927\u4E9A\u7BA1\u7406\u529E\u516C\u5BA4"),u("div",{class:"text-xl"},"\u7ECF\u6D4E\u8FD0\u884C\u7EDF\u8BA1\u5206\u6790\u7BA1\u7406\u7CFB\u7EDF")],-1)),e[6]||(e[6]=u("p",{class:"mt-2 text-center text-sm text-gray-600"}," \u8BF7\u767B\u5F55\u60A8\u7684\u8D26\u53F7 ",-1)),u("p",_,[e[4]||(e[4]=i(" \u8FD8\u6CA1\u6709\u8D26\u53F7\uFF1F ")),F(d,{to:"/user/register",class:"text-blue-600 hover:text-blue-500"},{default:D(()=>e[3]||(e[3]=[i(" \u7ACB\u5373\u6CE8\u518C ")])),_:1})])]),u("form",{class:"mt-8 space-y-6",onSubmit:B(b,["prevent"])},[u("div",M,[u("div",null,[e[8]||(e[8]=u("label",{for:"company",class:"sr-only"},"\u9009\u62E9\u516C\u53F8",-1)),p(u("select",{id:"company","onUpdate:modelValue":e[0]||(e[0]=s=>t.company=s),required:"",class:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm"},e[7]||(e[7]=[u("option",{value:""},"\u8BF7\u9009\u62E9\u516C\u53F8",-1),u("option",{value:"\u4E0A\u6D77\u5357\u534E\u5170\u9675\u7535\u6C14\u6709\u9650\u516C\u53F8"},"\u4E0A\u6D77\u5357\u534E\u5170\u9675\u7535\u6C14\u6709\u9650\u516C\u53F8",-1),u("option",{value:"\u4E0A\u6D77\u5357\u534E\u5170\u9675\u5B9E\u4E1A\u6709\u9650\u516C\u53F8"},"\u4E0A\u6D77\u5357\u534E\u5170\u9675\u5B9E\u4E1A\u6709\u9650\u516C\u53F8",-1),u("option",{value:"\u5E38\u5DDE\u62D3\u6E90\u7535\u6C14\u96C6\u56E2\u6709\u9650\u516C\u53F8"},"\u5E38\u5DDE\u62D3\u6E90\u7535\u6C14\u96C6\u56E2\u6709\u9650\u516C\u53F8",-1)]),512),[[h,t.company]])]),u("div",null,[e[9]||(e[9]=u("label",{for:"username",class:"sr-only"},"\u7528\u6237\u540D",-1)),p(u("input",{id:"username","onUpdate:modelValue":e[1]||(e[1]=s=>t.username=s),type:"text",required:"",class:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"\u7528\u6237\u540D"},null,512),[[f,t.username]])]),u("div",null,[e[10]||(e[10]=u("label",{for:"password",class:"sr-only"},"\u5BC6\u7801",-1)),p(u("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=s=>t.password=s),type:"password",required:"",class:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"\u5BC6\u7801"},null,512),[[f,t.password]])])]),l.value?(a(),n("div",T,y(l.value),1)):A("",!0),u("div",null,[u("button",{type:"submit",disabled:r.value,class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[u("span",j,[r.value?(a(),n("svg",O,e[12]||(e[12]=[u("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),u("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(a(),n("svg",q,e[11]||(e[11]=[u("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"},null,-1)])))]),i(" "+y(r.value?"\u767B\u5F55\u4E2D...":"\u767B\u5F55"),1)],8,U)])],32)])])}}});export{P as default};
