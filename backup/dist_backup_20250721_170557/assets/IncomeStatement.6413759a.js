import{r as f,d as O,C as q,o as N,c,a as e,y as p,B as b,F as g,l as v,m as S,b as U,G as j,v as M,f as F,t as x,q as V}from"./index.8819bd40.js";import{_ as R,M as $,r as J,l as L}from"./FormAttachmentAndRemarks.dcfcaa75.js";const z=()=>{const E=f([{title:"\u4E00\u3001\u8425\u4E1A\u603B\u6536\u5165",items:[{name:"\u8425\u4E1A\u603B\u6536\u5165",field:"total_revenue",currentAmount:null,yearAmount:null,isBold:!0},{name:"\u5176\u4E2D\uFF1A\u4E3B\u8425\u4E1A\u52A1\u6536\u5165",field:"main_business_revenue",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u5176\u4ED6\u4E1A\u52A1\u6536\u5165",field:"other_business_revenue",currentAmount:null,yearAmount:null,isSubItem:!0}]},{title:"\u4E8C\u3001\u8425\u4E1A\u603B\u6210\u672C",items:[{name:"\u8425\u4E1A\u603B\u6210\u672C",field:"total_cost",currentAmount:null,yearAmount:null,isBold:!0},{name:"\u8425\u4E1A\u6210\u672C",field:"operating_cost",currentAmount:null,yearAmount:null},{name:"\u5176\u4E2D\uFF1A\u4E3B\u8425\u4E1A\u52A1\u6210\u672C",field:"main_business_cost",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u5176\u4ED6\u4E1A\u52A1\u6210\u672C",field:"other_business_cost",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u7A0E\u91D1\u53CA\u9644\u52A0",field:"taxes_and_surcharges",currentAmount:null,yearAmount:null},{name:"\u9500\u552E\u8D39\u7528",field:"selling_expenses",currentAmount:null,yearAmount:null},{name:"\u7BA1\u7406\u8D39\u7528",field:"management_expenses",currentAmount:null,yearAmount:null},{name:"\u7814\u53D1\u8D39\u7528",field:"research_expenses",currentAmount:null,yearAmount:null},{name:"\u8D22\u52A1\u8D39\u7528",field:"financial_expenses",currentAmount:null,yearAmount:null},{name:"\u5176\u4E2D\uFF1A\u5229\u606F\u8D39\u7528",field:"interest_expense",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u5229\u606F\u6536\u5165",field:"interest_income",currentAmount:null,yearAmount:null,isSubItem:!0},{name:'\u6C47\u5151\u51C0\u635F\u5931\uFF08\u51C0\u6536\u76CA\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"exchange_loss",currentAmount:null,yearAmount:null},{name:"\u5176\u4ED6",field:"other_financial_expenses",currentAmount:null,yearAmount:null,isSubItem:!0}]},{title:"\u52A0\uFF1A\u5176\u4ED6\u6536\u76CA",items:[{name:"\u5176\u4ED6\u6536\u76CA",field:"other_income",currentAmount:null,yearAmount:null}]},{title:"\u6295\u8D44\u6536\u76CA",items:[{name:'\u6295\u8D44\u6536\u76CA\uFF08\u635F\u5931\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"investment_income",currentAmount:null,yearAmount:null},{name:"\u5176\u4E2D\uFF1A\u5BF9\u8054\u8425\u4F01\u4E1A\u548C\u5408\u8425\u4F01\u4E1A\u7684\u6295\u8D44\u6536\u76CA",field:"investment_income_associates",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u4EE5\u644A\u4F59\u6210\u672C\u8BA1\u91CF\u7684\u91D1\u878D\u8D44\u4EA7\u7EC8\u6B62\u786E\u8BA4\u6536\u76CA",field:"financial_assets_income",currentAmount:null,yearAmount:null}]},{title:"\u516C\u5141\u4EF7\u503C\u53D8\u52A8\u6536\u76CA",items:[{name:'\u516C\u5141\u4EF7\u503C\u53D8\u52A8\u6536\u76CA\uFF08\u635F\u5931\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"fair_value_change_income",currentAmount:null,yearAmount:null}]},{title:"\u4FE1\u7528\u51CF\u503C\u635F\u5931",items:[{name:'\u4FE1\u7528\u51CF\u503C\u635F\u5931\uFF08\u635F\u5931\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"credit_impairment_loss",currentAmount:null,yearAmount:null}]},{title:"\u8D44\u4EA7\u51CF\u503C\u635F\u5931",items:[{name:'\u8D44\u4EA7\u51CF\u503C\u635F\u5931\uFF08\u635F\u5931\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"asset_impairment_loss",currentAmount:null,yearAmount:null}]},{title:"\u8D44\u4EA7\u5904\u7F6E\u6536\u76CA",items:[{name:'\u8D44\u4EA7\u5904\u7F6E\u6536\u76CA\uFF08\u635F\u5931\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"asset_disposal_income",currentAmount:null,yearAmount:null}]},{title:"\u4E09\u3001\u8425\u4E1A\u5229\u6DA6",items:[{name:'\u8425\u4E1A\u5229\u6DA6\uFF08\u4E8F\u635F\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"operating_profit",currentAmount:null,yearAmount:null,isBold:!0}]},{title:"\u52A0\uFF1A\u8425\u4E1A\u5916\u6536\u5165",items:[{name:"\u8425\u4E1A\u5916\u6536\u5165",field:"non_operating_income",currentAmount:null,yearAmount:null},{name:"\u5176\u4E2D\uFF1A\u653F\u5E9C\u8865\u52A9",field:"government_grants",currentAmount:null,yearAmount:null,isSubItem:!0}]},{title:"\u51CF\uFF1A\u8425\u4E1A\u5916\u652F\u51FA",items:[{name:"\u8425\u4E1A\u5916\u652F\u51FA",field:"non_operating_expenses",currentAmount:null,yearAmount:null}]},{title:"\u56DB\u3001\u5229\u6DA6\u603B\u989D",items:[{name:'\u5229\u6DA6\u603B\u989D\uFF08\u4E8F\u635F\u603B\u989D\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"total_profit",currentAmount:null,yearAmount:null,isBold:!0}]},{title:"\u51CF\uFF1A\u6240\u5F97\u7A0E\u8D39\u7528",items:[{name:"\u6240\u5F97\u7A0E\u8D39\u7528",field:"income_tax_expense",currentAmount:null,yearAmount:null}]},{title:"\u4E94\u3001\u51C0\u5229\u6DA6",items:[{name:'\u51C0\u5229\u6DA6\uFF08\u51C0\u4E8F\u635F\u4EE5"-"\u53F7\u586B\u5217\uFF09',field:"net_profit",currentAmount:null,yearAmount:null,isBold:!0},{name:"\uFF08\u4E00\uFF09\u6309\u6240\u6709\u6743\u5F52\u5C5E\u5206\u7C7B\uFF1A",field:"ownership_classification",currentAmount:null,yearAmount:null},{name:"\u5F52\u5C5E\u4E8E\u6BCD\u516C\u53F8\u6240\u6709\u8005\u7684\u51C0\u5229\u6DA6",field:"parent_company_net_profit",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u5C11\u6570\u80A1\u4E1C\u635F\u76CA",field:"minority_interest_profit",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\uFF08\u4E8C\uFF09\u6309\u7ECF\u8425\u6301\u7EED\u6027\u5206\u7C7B\uFF1A",field:"continuity_classification",currentAmount:null,yearAmount:null},{name:"\u6301\u7EED\u7ECF\u8425\u51C0\u5229\u6DA6",field:"continuing_operation_profit",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u7EC8\u6B62\u7ECF\u8425\u51C0\u5229\u6DA6",field:"discontinued_operation_profit",currentAmount:null,yearAmount:null,isSubItem:!0}]},{title:"\u516D\u3001\u5176\u4ED6\u7EFC\u5408\u6536\u76CA\u7684\u7A0E\u540E\u51C0\u989D",items:[{name:"\u5176\u4ED6\u7EFC\u5408\u6536\u76CA\u7684\u7A0E\u540E\u51C0\u989D",field:"other_comprehensive_income",currentAmount:null,yearAmount:null,isBold:!0},{name:"\u5F52\u5C5E\u4E8E\u6BCD\u516C\u53F8\u6240\u6709\u8005\u7684\u5176\u4ED6\u7EFC\u5408\u6536\u76CA\u7684\u7A0E\u540E\u51C0\u989D",field:"parent_other_comprehensive_income",currentAmount:null,yearAmount:null},{name:"\uFF08\u4E00\uFF09\u4E0D\u80FD\u91CD\u5206\u7C7B\u8FDB\u635F\u76CA\u7684\u5176\u4ED6\u7EFC\u5408\u6536\u76CA",field:"non_reclassifiable_oci",currentAmount:null,yearAmount:null},{name:"1.\u91CD\u65B0\u8BA1\u91CF\u8BBE\u5B9A\u53D7\u76CA\u8BA1\u5212\u53D8\u52A8\u989D",field:"remeasure_defined_benefit_plans",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"2.\u6743\u76CA\u6CD5\u4E0B\u4E0D\u80FD\u8F6C\u635F\u76CA\u7684\u5176\u4ED6\u7EFC\u5408\u6536\u76CA",field:"equity_method_non_reclassifiable",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"3.\u5176\u4ED6\u6743\u76CA\u5DE5\u5177\u6295\u8D44\u516C\u5141\u4EF7\u503C\u53D8\u52A8",field:"other_equity_investment_fv_change",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"4.\u4F01\u4E1A\u81EA\u8EAB\u4FE1\u7528\u98CE\u9669\u516C\u5141\u4EF7\u503C\u53D8\u52A8",field:"credit_risk_fv_change",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"5.\u5176\u4ED6",field:"other_non_reclassifiable",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\uFF08\u4E8C\uFF09\u5C06\u91CD\u5206\u7C7B\u8FDB\u635F\u76CA\u7684\u5176\u4ED6\u7EFC\u5408\u6536\u76CA",field:"reclassifiable_oci",currentAmount:null,yearAmount:null},{name:"1.\u6743\u76CA\u6CD5\u4E0B\u53EF\u8F6C\u635F\u76CA\u7684\u5176\u4ED6\u7EFC\u5408\u6536\u76CA",field:"equity_method_reclassifiable",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"2.\u5176\u4ED6\u503A\u6743\u6295\u8D44\u516C\u5141\u4EF7\u503C\u53D8\u52A8",field:"debt_investment_fv_change",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"3.\u53EF\u4F9B\u51FA\u552E\u91D1\u878D\u8D44\u4EA7\u516C\u5141\u4EF7\u503C\u53D8\u52A8\u635F\u76CA",field:"available_for_sale_fv_change",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"4.\u91D1\u878D\u8D44\u4EA7\u91CD\u5206\u7C7B\u8BA1\u5165\u5176\u4ED6\u7EFC\u5408\u6536\u76CA\u7684\u91D1\u989D",field:"financial_assets_reclassified_to_oci",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"5.\u6301\u6709\u81F3\u5230\u671F\u6295\u8D44\u91CD\u5206\u7C7B\u4E3A\u53EF\u4F9B\u51FA\u552E\u91D1\u878D\u8D44\u4EA7\u635F\u76CA",field:"htm_reclassified_to_available_for_sale",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"6.\u5176\u4ED6\u503A\u6743\u6295\u8D44\u4FE1\u7528\u51CF\u503C\u51C6\u5907",field:"other_debt_investment_credit_impairment",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"7.\u73B0\u91D1\u6D41\u91CF\u5957\u671F\u50A8\u5907",field:"cash_flow_hedge_reserve",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"8.\u5916\u5E01\u8D22\u52A1\u62A5\u8868\u6298\u7B97\u5DEE\u989D",field:"foreign_currency_translation",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"9.\u5176\u4ED6",field:"other_reclassifiable",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u5F52\u5C5E\u4E8E\u5C11\u6570\u80A1\u4E1C\u7684\u5176\u4ED6\u7EFC\u5408\u6536\u76CA\u7684\u7A0E\u540E\u51C0\u989D",field:"minority_other_comprehensive_income",currentAmount:null,yearAmount:null}]},{title:"\u4E03\u3001\u7EFC\u5408\u6536\u76CA\u603B\u989D",items:[{name:"\u7EFC\u5408\u6536\u76CA\u603B\u989D",field:"total_comprehensive_income",currentAmount:null,yearAmount:null,isBold:!0}]},{title:"\u516B\u3001\u6BCF\u80A1\u6536\u76CA",items:[{name:"\u57FA\u672C\u6BCF\u80A1\u6536\u76CA",field:"basic_earnings_per_share",currentAmount:null,yearAmount:null,isSubItem:!0},{name:"\u7A00\u91CA\u6BCF\u80A1\u6536\u76CA",field:"diluted_earnings_per_share",currentAmount:null,yearAmount:null,isSubItem:!0}]}]);return{incomeStatementData:E,convertToStorageFormat:r=>{const o={};return E.value.forEach(A=>{A.items.forEach(a=>{o[a.field]={current_amount:a.currentAmount,year_amount:a.yearAmount}})}),{period:r,data:JSON.stringify(o)}},restoreFromStorageFormat:r=>{const o=JSON.parse(r.data);E.value.forEach(A=>{A.items.forEach(a=>{const m=o[a.field];m&&(a.currentAmount=m.current_amount,a.yearAmount=m.year_amount)})})}}},G={class:"max-w-[1200px] mx-auto bg-white rounded-lg shadow-lg p-6"},H={class:"flex justify-between items-center mb-6"},K={class:"flex items-center space-x-4"},P={class:"overflow-x-auto"},Q={class:"w-full border-collapse border border-gray-300"},W={class:"border border-gray-300 px-4 py-2 font-bold"},X={class:"border border-gray-300 px-4 py-2"},Y=["onUpdate:modelValue","data-field"],Z={class:"border border-gray-300 px-4 py-2"},uu=["onUpdate:modelValue","data-field"],nu=O({__name:"IncomeStatement",setup(E){var h;const C=j(),B=M(),r=f(((h=C.query.period)==null?void 0:h.toString())||new Date().toISOString().slice(0,7)),{incomeStatementData:o,convertToStorageFormat:A,restoreFromStorageFormat:a}=z(),m=$.INCOME_STATEMENT,D=f(""),_=f(""),y=async t=>{try{const u=await fetch(`http://47.111.95.19:3000/income-statement/${t}`);if(!u.ok){if(u.status!==404)throw new Error("\u52A0\u8F7D\u6570\u636E\u5931\u8D25");return}const n=await u.json();if(n.data){const s=typeof n.data=="string"?JSON.parse(n.data):n.data;Object.keys(s).forEach(l=>{const d=o.value.flatMap(i=>i.items).find(i=>i.field===l);d&&(d.currentAmount=s[l].current_amount,d.yearAmount=s[l].year_amount)})}}catch(u){console.error("\u52A0\u8F7D\u6570\u636E\u5931\u8D25:",u)}},I=()=>{B.replace({query:{...C.query,period:r.value}}),y(r.value)};q(()=>C.query.period,t=>{t&&(r.value=t.toString(),y(t.toString()))});const w=async()=>{try{const t=A(r.value),u=await fetch("http://47.111.95.19:3000/income-statement",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!u.ok){const s=await u.json();throw new Error(s.error||"\u4FDD\u5B58\u5931\u8D25")}const n=await u.json();await J(m,r.value,t,D.value,_.value),alert("\u4FDD\u5B58\u6210\u529F"),console.log("\u4FDD\u5B58\u6210\u529F:",n.message)}catch(t){console.error("\u4FDD\u5B58\u5931\u8D25:",t)}},k=()=>{o.value.forEach(t=>{t.items.forEach(u=>{u.currentAmount=null,u.yearAmount=null})})},T=async()=>{const{remarks:t,suggestions:u}=await L(m,r.value);D.value=t,_.value=u};return N(()=>{y(r.value),T()}),(t,u)=>(F(),c("div",G,[e("div",H,[u[3]||(u[3]=e("h1",{class:"text-2xl font-bold"},"\u5229\u6DA6\u8868(\u4E3B\u8868)\uFF08\u5355\u4F4D\uFF1A\u4E07\u5143\uFF09",-1)),e("div",K,[p(e("input",{"onUpdate:modelValue":u[0]||(u[0]=n=>r.value=n),type:"month",class:"px-3 py-2 border rounded",onChange:I},null,544),[[b,r.value]])])]),e("div",P,[e("table",Q,[u[6]||(u[6]=e("thead",{class:"sticky top-0 bg-white"},[e("tr",{class:"bg-gray-50"},[e("th",{class:"border border-gray-300 px-4 py-2"},"\u9879\u76EE"),e("th",{class:"border border-gray-300 px-4 py-2 w-40"},"\u672C\u671F\u91D1\u989D"),e("th",{class:"border border-gray-300 px-4 py-2 w-40"},"\u672C\u5E74\u7D2F\u8BA1")])],-1)),e("tbody",null,[(F(!0),c(g,null,v(S(o),(n,s)=>(F(),c(g,{key:s},[e("tr",null,[e("td",W,x(n.title),1),u[4]||(u[4]=e("td",{class:"border border-gray-300 px-4 py-2"},null,-1)),u[5]||(u[5]=e("td",{class:"border border-gray-300 px-4 py-2"},null,-1))]),(F(!0),c(g,null,v(n.items,(l,d)=>(F(),c("tr",{key:`${s}-${d}`},[e("td",{class:V(["border border-gray-300 px-4 py-2",l.isSubItem?"pl-8":"",l.isBold?"font-bold":""])},x(l.name),3),e("td",X,[p(e("input",{"onUpdate:modelValue":i=>l.currentAmount=i,type:"number",class:"w-full px-2 py-1 border rounded",step:"0.01","data-field":l.field},null,8,Y),[[b,l.currentAmount]])]),e("td",Z,[p(e("input",{"onUpdate:modelValue":i=>l.yearAmount=i,type:"number",class:"w-full px-2 py-1 border rounded",step:"0.01","data-field":`${l.field}_year`},null,8,uu),[[b,l.yearAmount]])])]))),128))],64))),128))])])]),e("div",{class:"mt-4 flex justify-end space-x-4"},[e("button",{onClick:w,class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"}," \u4FDD\u5B58 "),e("button",{onClick:k,class:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600"}," \u91CD\u7F6E ")]),U(R,{"module-id":S(m),period:r.value,remarks:D.value,"onUpdate:remarks":u[1]||(u[1]=n=>D.value=n),suggestions:_.value,"onUpdate:suggestions":u[2]||(u[2]=n=>_.value=n)},null,8,["module-id","period","remarks","suggestions"])]))}});export{nu as default};
