import{d as P,r as s,o as Y,a as k,b as m,e as a,y as A,z as N,F as R,g as M,x as H,t as C,v as g}from"./index.ddf2ed0e.js";import{i as F,L as d}from"./index.0a005eaa.js";const $={class:"max-w-[1600px] mx-auto bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-xl p-6"},W={class:"flex justify-between items-center mb-6 border-b border-gray-200 pb-3"},O={class:"flex items-center space-x-3"},T=["value"],V={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4"},j={class:"bg-white p-4 rounded-xl shadow-md border border-gray-100 transition-all hover:shadow-lg"},I={class:"bg-white p-4 rounded-xl shadow-md border border-gray-100 transition-all hover:shadow-lg"},U={class:"text-xs text-gray-500 text-center mt-2"},K=P({__name:"ChartVisualization",setup(G){const f=s(null),p=s(null),l=s(new Date().getFullYear().toString()),u=s([]),n=s(null),r=s(null),i=s({periods:[],mainBusinessRevenue:[],netProfit:[]}),D=()=>{z(),L()},z=()=>{if(!f.value)return;n.value=F(f.value);const o={title:{text:"\u4E3B\u8425\u6536\u5165\u8D8B\u52BF",textStyle:{fontSize:16,fontWeight:"bold",color:"#333",fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif'},left:"center",top:5,subtext:l.value+"\u5E74",subtextStyle:{fontSize:12,color:"#666"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow",shadowStyle:{color:"rgba(0, 0, 0, 0.05)"}},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#333",fontSize:12},formatter:function(e){const t=e[0].value;return`<div class="font-semibold text-xs">${e[0].name}</div>
                <div class="flex items-center mt-1">
                  <span style="display:inline-block;margin-right:5px;border-radius:50%;width:8px;height:8px;background-color:${e[0].color};"></span>
                  <span>${e[0].seriesName}: ${t.toLocaleString("zh-CN",{maximumFractionDigits:2})} \u5143</span>
                </div>`},extraCssText:"box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); border-radius: 4px; padding: 8px;"},grid:{left:"8%",right:"5%",bottom:"15%",top:"25%",containLabel:!0},xAxis:{type:"category",data:i.value.periods,axisLabel:{interval:0,rotate:45,fontSize:10,color:"#555",fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif'},axisLine:{lineStyle:{color:"#ddd"}},axisTick:{alignWithLabel:!0,lineStyle:{color:"#ddd"}},splitLine:{show:!1}},yAxis:{type:"value",name:"\u4E07\u5143",nameTextStyle:{padding:[0,0,0,0],color:"#666",fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif',fontSize:10},axisLine:{show:!0,lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#f5f5f5",type:"dashed"}},axisLabel:{formatter:function(e){return e>0?e.toLocaleString("zh-CN",{maximumFractionDigits:0}):0},fontSize:10,fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif'}},series:[{name:"\u4E3B\u8425\u6536\u5165",type:"bar",data:i.value.mainBusinessRevenue,barWidth:"40%",itemStyle:{color:new d(0,0,0,1,[{offset:0,color:"#83bff6"},{offset:.5,color:"#188df0"},{offset:1,color:"#188df0"}]),borderRadius:[4,4,0,0]},emphasis:{itemStyle:{color:new d(0,0,0,1,[{offset:0,color:"#5470c6"},{offset:.7,color:"#1062d0"},{offset:1,color:"#0d55b0"}])},label:{show:!0,position:"top",formatter:function(e){return e.value.toLocaleString("zh-CN",{maximumFractionDigits:0})},fontSize:10}},label:{show:!1,position:"top",formatter:function(e){return e.value.toLocaleString("zh-CN",{maximumFractionDigits:0})},fontSize:10,fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif',color:"#666",distance:4},animation:!0,animationDuration:1200,animationEasing:"elasticOut"}],animation:!0};n.value.setOption(o)},L=()=>{if(!p.value)return;r.value=F(p.value);const o={title:{text:"\u51C0\u5229\u6DA6\u8D8B\u52BF",textStyle:{fontSize:16,fontWeight:"bold",color:"#333",fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif'},left:"center",top:5,subtext:l.value+"\u5E74",subtextStyle:{fontSize:12,color:"#666"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow",shadowStyle:{color:"rgba(0, 0, 0, 0.05)"}},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:"#eee",borderWidth:1,textStyle:{color:"#333",fontSize:12},formatter:function(e){const t=e[0].value;return`<div class="font-semibold text-xs">${e[0].name}</div>
                <div class="flex items-center mt-1">
                  <span style="display:inline-block;margin-right:5px;border-radius:50%;width:8px;height:8px;background-color:${e[0].color};"></span>
                  <span>${e[0].seriesName}: ${t.toLocaleString("zh-CN",{maximumFractionDigits:2})} \u5143</span>
                </div>`},extraCssText:"box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); border-radius: 4px; padding: 8px;"},grid:{left:"8%",right:"5%",bottom:"15%",top:"25%",containLabel:!0},xAxis:{type:"category",data:i.value.periods,axisLabel:{interval:0,rotate:45,fontSize:10,color:"#555",fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif'},axisLine:{lineStyle:{color:"#ddd"}},axisTick:{alignWithLabel:!0,lineStyle:{color:"#ddd"}},splitLine:{show:!1}},yAxis:{type:"value",name:"\u4E07\u5143",nameTextStyle:{padding:[0,0,0,0],color:"#666",fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif',fontSize:10},axisLine:{show:!0,lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#f5f5f5",type:"dashed"}},axisLabel:{formatter:function(e){return e>0?e.toLocaleString("zh-CN",{maximumFractionDigits:0}):0},fontSize:10,fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif'}},series:[{name:"\u51C0\u5229\u6DA6",type:"bar",data:i.value.netProfit,barWidth:"40%",itemStyle:{color:new d(0,0,0,1,[{offset:0,color:"#91cc75"},{offset:.5,color:"#4ca636"},{offset:1,color:"#4ca636"}]),borderRadius:[4,4,0,0]},emphasis:{itemStyle:{color:new d(0,0,0,1,[{offset:0,color:"#79bb5e"},{offset:.7,color:"#3d8a29"},{offset:1,color:"#2f7016"}])},label:{show:!0,position:"top",formatter:function(e){return e.value.toLocaleString("zh-CN",{maximumFractionDigits:0})},fontSize:10}},label:{show:!1,position:"top",formatter:function(e){return e.value.toLocaleString("zh-CN",{maximumFractionDigits:0})},fontSize:10,fontFamily:'"PingFang SC", "Microsoft YaHei", sans-serif',color:"#666",distance:4},animation:!0,animationDuration:1200,animationEasing:"elasticOut"}],animation:!0};r.value.setOption(o)},E=()=>{n.value&&n.value.setOption({xAxis:{data:i.value.periods},series:[{data:i.value.mainBusinessRevenue}]}),r.value&&r.value.setOption({xAxis:{data:i.value.periods},series:[{data:i.value.netProfit}]})},x=async()=>{try{const o=await fetch(`http://47.111.95.19:3000/income-statement/annual/${l.value}`);if(!o.ok)throw new Error("\u83B7\u53D6\u6570\u636E\u5931\u8D25");const e=await o.json(),t=[],v=[],b=[];e.data&&Array.isArray(e.data)&&e.data.forEach(c=>{var S,w;const B=c.period.split("-")[1];t.push(`${B}\u6708`);const y=typeof c.data=="string"?JSON.parse(c.data):c.data;v.push(((S=y.main_business_revenue)==null?void 0:S.current_amount)||0),b.push(((w=y.net_profit)==null?void 0:w.current_amount)||0)}),i.value.periods=t,i.value.mainBusinessRevenue=v,i.value.netProfit=b,E(),e.year&&!u.value.includes(e.year)&&u.value.push(e.year)}catch(o){console.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25:",o)}},_=async()=>{try{const o=new Date().getFullYear(),e=[];for(let t=0;t<5;t++)e.push((o-t).toString());u.value=e}catch(o){console.error("\u83B7\u53D6\u5E74\u4EFD\u5217\u8868\u5931\u8D25:",o)}};Y(async()=>{await _(),await x(),D(),window.addEventListener("resize",h)}),k(()=>{n.value&&n.value.dispose(),r.value&&r.value.dispose(),window.removeEventListener("resize",h)});const h=()=>{n.value&&n.value.resize(),r.value&&r.value.resize()};return(o,e)=>(g(),m("div",$,[a("div",W,[e[2]||(e[2]=a("h1",{class:"text-xl font-bold text-gray-800"},"\u8D22\u52A1\u6570\u636E\u53EF\u89C6\u5316",-1)),a("div",O,[e[1]||(e[1]=a("span",{class:"text-sm text-gray-600"},"\u9009\u62E9\u5E74\u4EFD:",-1)),A(a("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>l.value=t),class:"px-3 py-1.5 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",onChange:x},[(g(!0),m(R,null,M(u.value,t=>(g(),m("option",{key:t,value:t},C(t)+"\u5E74",9,T))),128))],544),[[N,l.value]])])]),a("div",V,[a("div",j,[a("div",{class:"h-[350px]",ref_key:"revenueChartRef",ref:f},null,512)]),a("div",I,[a("div",{class:"h-[350px]",ref_key:"profitChartRef",ref:p},null,512),e[3]||(e[3]=H(" \u6CA1\u4E8B "))])]),a("div",U,[a("p",null,"\u6570\u636E\u6765\u6E90: \u5229\u6DA6\u8868 | \u6700\u540E\u66F4\u65B0\u65F6\u95F4: "+C(new Date().toLocaleDateString()),1)])]))}});export{K as default};
