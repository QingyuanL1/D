import{_ as B,d as C,r as l,B as S,o as q,b as y,e as u,y as x,A as h,F as m,g as D,k,h as z,G as A,v as d,t as O}from"./index.f4f670c7.js";import{_ as N,M as R,r as U,l as M}from"./FormAttachmentAndRemarks.4d389de7.js";const T={class:"max-w-[1500px] mx-auto bg-white rounded-lg shadow-lg p-6"},V={class:"flex justify-between items-center mb-6"},I={class:"flex items-center space-x-4"},J={class:"overflow-x-auto my-6"},L={class:"w-full border-collapse border border-gray-300"},$={class:"border border-gray-300 px-4 py-2 font-medium bg-gray-50"},G=["onUpdate:modelValue"],X=C({__name:"CostCenterStructure",setup(H){var w;const t=A(),i=l(((w=t.query.period)==null?void 0:w.toString())||new Date().toISOString().slice(0,7)),b=R.EXAMPLE_COST_CENTER,r=l(""),s=l(""),f=["yibao","erbao","xinnengyuan","qiangxiu","yunjian","jianli","yunei","yuwai","yuwaisuzhou","shebeiwaifu","total"],p=[{name:"\u603B\u7ECF\u7406\u5BA4",yibao:116.8,erbao:37.53,xinnengyuan:34,qiangxiu:9.38,yunjian:37.53,jianli:null,yunei:6.8,yuwai:null,yuwaisuzhou:13.6,shebeiwaifu:null,total:255.63},{name:"\u7ECF\u8425\u90E8",yibao:160.55,erbao:19.8,xinnengyuan:86.34,qiangxiu:null,yunjian:7.45,jianli:2.72,yunei:10.87,yuwai:13.88,yuwaisuzhou:2.95,shebeiwaifu:null,total:304.45},{name:"\u7ECF\u7BA1\u90E8",yibao:-9.89,erbao:-5.89,xinnengyuan:-4.85,qiangxiu:null,yunjian:-2.21,jianli:-.15,yunei:-6.34,yuwai:-8.09,yuwaisuzhou:-1.15,shebeiwaifu:0,total:-38.57},{name:"\u5B89\u8D28\u90E8",yibao:35.29,erbao:23.13,xinnengyuan:null,qiangxiu:null,yunjian:9.7,jianli:null,yunei:null,yuwai:null,yuwaisuzhou:null,shebeiwaifu:null,total:67.12},{name:"\u5DE5\u7A0B\u90E8",yibao:302.02,erbao:113.29,xinnengyuan:null,qiangxiu:null,yunjian:84.89,jianli:.67,yunei:null,yuwai:null,yuwaisuzhou:null,shebeiwaifu:null,total:500.87},{name:"\u8FD0\u68C0\u90E8",yibao:null,erbao:null,xinnengyuan:136.34,qiangxiu:132.14,yunjian:17.43,jianli:7.5,yunei:null,yuwai:null,yuwaisuzhou:null,shebeiwaifu:null,total:293.41},{name:"\u8425\u9500\u90E8-\u9500\u552E",yibao:97.98,erbao:108.4,xinnengyuan:48.11,qiangxiu:0,yunjian:13.28,jianli:.82,yunei:0,yuwai:0,yuwaisuzhou:0,shebeiwaifu:0,total:268.69},{name:"\u8425\u9500\u90E8-\u5546\u52A1",yibao:45.76,erbao:24.4,xinnengyuan:20.1,qiangxiu:.95,yunjian:9.18,jianli:0,yunei:26.27,yuwai:35.54,yuwaisuzhou:0,shebeiwaifu:0,total:160.19},{name:"\u8425\u9500\u90E8-\u8BBE\u5907",yibao:0,erbao:0,xinnengyuan:0,qiangxiu:0,yunjian:0,jianli:0,yunei:0,yuwai:0,yuwaisuzhou:0,shebeiwaifu:3.04,total:3.04},{name:"\u8425\u9500\u90E8-\u62D3\u5C55",yibao:0,erbao:0,xinnengyuan:0,qiangxiu:0,yunjian:0,jianli:0,yunei:32.8,yuwai:30.54,yuwaisuzhou:8.48,shebeiwaifu:0,total:71.82},{name:"\u8425\u9500\u90E8-\u76D1\u7406",yibao:null,erbao:null,xinnengyuan:null,qiangxiu:null,yunjian:null,jianli:null,yunei:null,yuwai:null,yuwaisuzhou:null,shebeiwaifu:null,total:0},{name:"\u5408\u8BA1",yibao:748.51,erbao:320.66,xinnengyuan:320.04,qiangxiu:142.48,yunjian:176.23,jianli:11.65,yunei:70.4,yuwai:69.87,yuwaisuzhou:23.77,shebeiwaifu:3.04,total:1886.65},{name:"\u5360\u6536\u5165\u6BD4",yibao:8.07,erbao:3.46,xinnengyuan:3.45,qiangxiu:1.54,yunjian:1.9,jianli:.13,yunei:.76,yuwai:.75,yuwaisuzhou:.26,shebeiwaifu:.03,total:20.35}],o=l(p),c=async n=>{try{const a=await fetch(`http://47.111.95.19:3000/cost-center-structure/${n}`);if(!a.ok){if(a.status!==404)throw new Error("\u52A0\u8F7D\u6570\u636E\u5931\u8D25");return}const e=await a.json();e.data&&(o.value=e.data)}catch(a){console.error("\u52A0\u8F7D\u6570\u636E\u5931\u8D25:",a)}};S(()=>t.query.period,n=>{n&&(i.value=n.toString(),c(n.toString()))});const E=async()=>{try{if(!(await fetch("http://47.111.95.19:3000/cost-center-structure",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({period:i.value,data:o.value})})).ok)throw new Error("\u4FDD\u5B58\u5931\u8D25");await U(b,i.value,o.value,r.value,s.value),alert("\u4FDD\u5B58\u6210\u529F")}catch(n){console.error("\u4FDD\u5B58\u5931\u8D25:",n),alert("\u4FDD\u5B58\u5931\u8D25")}},v=()=>{o.value=JSON.parse(JSON.stringify(p))},j=async()=>{const{remarks:n,suggestions:a}=await M(b,i.value);r.value=n,s.value=a};return q(()=>{t.query.period&&c(t.query.period.toString()),j()}),(n,a)=>(d(),y("div",T,[u("div",V,[a[3]||(a[3]=u("h1",{class:"text-2xl font-bold"},"\u6210\u672C\u4E2D\u5FC3\u7ED3\u6784(\u4E3B\u8868)\uFF08\u5355\u4F4D\uFF1A\u4E07\u5143\uFF09",-1)),u("div",I,[x(u("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),type:"month",class:"px-3 py-2 border rounded"},null,512),[[h,i.value]])])]),u("div",J,[u("table",L,[a[4]||(a[4]=u("thead",{class:"sticky top-0 bg-white"},[u("tr",{class:"bg-gray-50"},[u("th",{class:"border border-gray-300 px-4 py-2 w-32"},"\u8D39\u7528\u60C5\u51B5"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u4E00\u5305"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u4E8C\u5305"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u65B0\u80FD\u6E90"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u62A2\u4FEE"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u8FD0\u68C0"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u76D1\u7406"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u57DF\u5185"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u57DF\u5916"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u57DF\u5916\u82CF\u5DDE"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u8BBE\u5907\u5916\u670D"),u("th",{class:"border border-gray-300 px-4 py-2 w-24"},"\u7D2F\u8BA1\u6570")])],-1)),u("tbody",null,[(d(!0),y(m,null,D(o.value,(e,F)=>(d(),y("tr",{key:F},[u("td",$,O(e.name),1),(d(),y(m,null,D(f,g=>u("td",{class:"border border-gray-300 px-4 py-2",key:g},[x(u("input",{"onUpdate:modelValue":_=>e[g]=_,type:"number",class:"w-full px-2 py-1 border rounded",step:"0.01"},null,8,G),[[h,e[g]]])])),64))]))),128))])])]),u("div",{class:"mt-4 flex justify-end space-x-4"},[u("button",{onClick:E,class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"}," \u4FDD\u5B58 "),u("button",{onClick:v,class:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600"}," \u91CD\u7F6E ")]),k(N,{"module-id":z(b),period:i.value,remarks:r.value,"onUpdate:remarks":a[1]||(a[1]=e=>r.value=e),suggestions:s.value,"onUpdate:suggestions":a[2]||(a[2]=e=>s.value=e)},null,8,["module-id","period","remarks","suggestions"])]))}});var Q=B(X,[["__scopeId","data-v-7d90f490"]]);export{Q as default};
