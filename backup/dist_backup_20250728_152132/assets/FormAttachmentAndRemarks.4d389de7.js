import{u as d,d as g,r as l,c as m,B as p,o as f,b as a,e as E,t as U,f as i,F as M,g as b,v as B}from"./index.f4f670c7.js";async function lu(_,r,N,t,s){var T;try{console.log("=== recordFormSubmission \u5F00\u59CB\u6267\u884C ===");const n=d(),C=(T=n.userInfo)==null?void 0:T.id;if(console.log("\u7528\u6237\u4FE1\u606F:",n.userInfo),console.log("\u7528\u6237ID:",C),!C)return console.warn("\u7528\u6237\u4FE1\u606F\u4E0D\u5B58\u5728\uFF0C\u8DF3\u8FC7\u63D0\u4EA4\u8BB0\u5F55"),!1;const O={userId:C,moduleId:_,period:r,formData:N,remarks:t,suggestions:s};console.log("\u53D1\u9001\u5230 /forms/submit \u7684\u6570\u636E:",O);const S=await fetch("http://47.111.95.19:3000/forms/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)});if(console.log("API \u54CD\u5E94\u72B6\u6001:",S.status),console.log("API \u54CD\u5E94\u72B6\u6001\u6587\u672C:",S.statusText),!S.ok){const D=await S.text();return console.error("\u63D0\u4EA4\u8BB0\u5F55\u4FDD\u5B58\u5931\u8D25\uFF0C\u54CD\u5E94\u5185\u5BB9:",D),!1}const I=await S.json();return console.log("\u63D0\u4EA4\u8BB0\u5F55\u4FDD\u5B58\u6210\u529F\uFF0C\u54CD\u5E94\u6570\u636E:",I),console.log("=== recordFormSubmission \u6267\u884C\u5B8C\u6210 ==="),!0}catch(n){return console.error("=== recordFormSubmission \u6267\u884C\u5F02\u5E38 ===",n),!1}}const u={BALANCE_SHEET:1,CASH_FLOW:2,INCOME_STATEMENT:3,BUSINESS_INCOME_STRUCTURE:4,MAIN_BUSINESS_INCOME:5,ORDER_TO_INCOME:6,STOCK_ORDER_TO_INCOME:7,NON_MAIN_BUSINESS:8,COST_CENTER_STRUCTURE:9,BUSINESS_CONTRIBUTION:10,BUSINESS_PROFIT_MARGIN:11,NET_PROFIT_STRUCTURE:12,MAIN_BUSINESS_NET_PROFIT:13,NON_MAIN_BUSINESS_NET_PROFIT:14,RECEIPT_STRUCTURE:15,ACCOUNTS_RECEIVABLE:16,OVERDUE_RECEIVABLES:17,BAD_DEBT_PROVISION:18,MAIN_BUSINESS_COST:26,COST_ESTIMATION:27,NEW_ORDERS:19,PROJECT_TRACKING:20,BIDDING_STATUS:21,BID_FULFILLMENT:22,INVENTORY_STRUCTURE:23,INVENTORY_IN_PROGRESS:24,CONTRACT_INVENTORY:25,INVENTORY_STOCK:36,PRODUCTION_VALUE:28,PRODUCTION_PLAN_EXECUTION:29,PRODUCTION_EXECUTION_ANALYSIS:30,DEPARTMENT_COST_CENTER:31,DEPARTMENT_COST_INPUT:32,MAJOR_INVESTMENT_ANALYSIS:33,BUDGET_EXECUTION:34,BUDGET_PLANNING:35,EXAMPLE_CASH_FLOW:201,EXAMPLE_COST_CENTER:202,EXAMPLE_INCOME_STATEMENT:203,EXAMPLE_PRODUCTION_VALUE:204,EXAMPLE_PROJECT_TRACKING:205,EXAMPLE_BALANCE_SHEET:206,NANHUA_NEW_ORDERS:300,NANHUA_PROJECT_TRACKING:301,NANHUA_BIDDING_STATUS:302,NANHUA_BUSINESS_INCOME:303,NANHUA_ORDER_TO_INCOME:304,NANHUA_NON_MAIN_BUSINESS:305,NANHUA_STOCK_ORDER_TO_INCOME:306,NANHUA_INVENTORY_STRUCTURE:307,NANHUA_BID_FULFILLMENT:308,NANHUA_MAIN_BUSINESS_COST:309,NANHUA_CONTRACT_INVENTORY:310,NANHUA_COST_PROVISION:311,NANHUA_COST_CENTER_STRUCTURE:312,DEPARTMENT_COST_CENTER_ACTUAL:313,NANHUA_DEPARTMENT_COST_INPUT:314,NANHUA_BUSINESS_CONTRIBUTION_WITH_SELF_BUILT:315,NANHUA_BUSINESS_PROFIT_MARGIN_WITH_SELF_BUILT:316,NANHUA_RECEIPT_STRUCTURE:317,NANHUA_CONTRACT_INVENTORY_EVALUATION:318,NANHUA_MAIN_BUSINESS_NET_PROFIT:319,NANHUA_NON_MAIN_BUSINESS_NET_PROFIT:320,NANHUA_ANALYSIS_APPENDIX:321,NANHUA_OVERDUE_RECEIVABLES:322,NANHUA_SELF_CONSTRUCTION_ANALYSIS:323,NANHUA_BAD_DEBT_PROVISION:324,NANHUA_CONSTRUCTION_PLAN_EXECUTION:325,NANHUA_CONSTRUCTION_EXECUTION_STATUS:326,NANHUA_MAJOR_INVESTMENT:327,TUOYUAN_NEW_ORDER_STRUCTURE:401,TUOYUAN_PROJECT_TRACKING:402,TUOYUAN_BIDDING_STATUS:403,MAIN_BUSINESS_INCOME_BREAKDOWN:404,TUOYUAN_ORDER_TO_INCOME:405,STOCK_ORDER_TO_INCOME:406,TUOYUAN_NON_MAIN_BUSINESS:407,TUOYUAN_INVENTORY_STRUCTURE:408,TUOYUAN_BID_FULFILLMENT:409,TUOYUAN_INVENTORY_IN_PROGRESS:410,TUOYUAN_INVENTORY_STATUS:411,TUOYUAN_MAIN_BUSINESS_COST_STRUCTURE_QUALITY:412,TUOYUAN_COST_ESTIMATION:413,TUOYUAN_COST_CENTER_PROFIT_LOSS:414,TUOYUAN_MAIN_BUSINESS_CONTRIBUTION_RATE:415,TUOYUAN_MAIN_BUSINESS_PROFIT_MARGIN:416,TUOYUAN_MAIN_BUSINESS_NET_PROFIT_CONTRIBUTION:417,PAYMENT_STRUCTURE_QUALITY:418,TUOYUAN_ACCOUNTS_RECEIVABLE:419,TUOYUAN_OVERDUE_RECEIVABLES:420,TUOYUAN_BAD_DEBT_PROVISION:421,TUOYUAN_CONSTRUCTION_PLAN_EXECUTION:422,TUOYUAN_MAJOR_INVESTMENT:423,TUOYUAN_MAIN_BUSINESS_PRODUCTION_VALUE_SELF_CONSTRUCTION:424,TUOYUAN_CONSTRUCTION_EXECUTION_STATUS:425},L={[u.BALANCE_SHEET]:"\u8D44\u4EA7\u8D1F\u503A\u8868",[u.CASH_FLOW]:"\u73B0\u91D1\u6D41\u91CF\u8868",[u.INCOME_STATEMENT]:"\u5229\u6DA6\u8868",[u.BUSINESS_INCOME_STRUCTURE]:"\u8425\u4E1A\u6536\u5165\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.MAIN_BUSINESS_INCOME]:"\u4E3B\u8425\u4E1A\u52A1\u6536\u5165\u5206\u89E3",[u.ORDER_TO_INCOME]:"\u4E3B\u8425\u4E1A\u52A1\u5F53\u5E74\u8BA2\u5355\u8F6C\u6536\u5165",[u.STOCK_ORDER_TO_INCOME]:"\u4E3B\u8425\u4E1A\u52A1\u5B58\u91CF\u8BA2\u5355\u8F6C\u6536\u5165",[u.NON_MAIN_BUSINESS]:"\u975E\u4E3B\u8425\u4E1A\u52A1\u60C5\u51B5",[u.COST_CENTER_STRUCTURE]:"\u6210\u672C\u4E2D\u5FC3\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.BUSINESS_CONTRIBUTION]:"\u4E3B\u8425\u4E1A\u52A1\u8FB9\u9645\u8D21\u732E\u7387",[u.BUSINESS_PROFIT_MARGIN]:"\u4E3B\u8425\u4E1A\u52A1\u6BDB\u5229\u7387",[u.NET_PROFIT_STRUCTURE]:"\u51C0\u5229\u6DA6\u7ED3\u6784",[u.MAIN_BUSINESS_NET_PROFIT]:"\u4E3B\u8425\u51C0\u5229\u6DA6\u8D21\u732E\u60C5\u51B5",[u.NON_MAIN_BUSINESS_NET_PROFIT]:"\u975E\u4E3B\u8425\u51C0\u5229\u6DA6\u8D21\u732E\u60C5\u51B5",[u.RECEIPT_STRUCTURE]:"\u6536\u6B3E\u7ED3\u6784",[u.ACCOUNTS_RECEIVABLE]:"\u5E94\u6536\u8D26\u6B3E",[u.OVERDUE_RECEIVABLES]:"\u903E\u671F\u5E94\u6536\u6B3E",[u.BAD_DEBT_PROVISION]:"\u574F\u8D26\u51C6\u5907\u60C5\u51B5",[u.MAIN_BUSINESS_COST]:"\u4E3B\u8425\u4E1A\u52A1\u6210\u672C",[u.COST_ESTIMATION]:"\u6210\u672C\u6682\u4F30\u5165\u5E93\u548C\u8BA1\u63D0",[u.DEPARTMENT_COST_CENTER]:"\u90E8\u95E8\u6210\u672C\u4E2D\u5FC3\u5B9E\u9645\u53D1\u751F",[u.DEPARTMENT_COST_INPUT]:"\u90E8\u95E8\u6210\u672C\u4E2D\u5FC3\u8BA1\u5165\u635F\u76CA",[u.MAJOR_INVESTMENT_ANALYSIS]:"\u5E74\u5EA6\u91CD\u5927\u6295\u8D44\u60C5\u51B5",[u.BUDGET_EXECUTION]:"\u9884\u7B97\u6267\u884C",[u.BUDGET_PLANNING]:"\u5E74\u5EA6\u9884\u7B97\u8BA1\u5212",[u.NEW_ORDERS]:"\u65B0\u7B7E\u8BA2\u5355",[u.PROJECT_TRACKING]:"\u9879\u76EE\u8DDF\u8E2A",[u.BIDDING_STATUS]:"\u62DB\u6295\u6807\u60C5\u51B5",[u.BID_FULFILLMENT]:"\u4E2D\u6807\u672A\u5C65\u7EA6",[u.INVENTORY_STRUCTURE]:"\u5B58\u91CF\u7ED3\u6784",[u.INVENTORY_IN_PROGRESS]:"\u5728\u4EA7\u60C5\u51B5",[u.CONTRACT_INVENTORY]:"\u5E93\u5B58\u60C5\u51B5(\u5408\u540C\u5B58\u91CF)",[u.INVENTORY_STOCK]:"\u5E93\u5B58\u60C5\u51B5",[u.PRODUCTION_VALUE]:"\u4EA7\u503C\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.PRODUCTION_PLAN_EXECUTION]:"\u751F\u4EA7\u8BA1\u5212\u6267\u884C\u60C5\u51B5",[u.PRODUCTION_EXECUTION_ANALYSIS]:"\u751F\u4EA7\u6267\u884C\u5206\u6790",[u.EXAMPLE_CASH_FLOW]:"\u73B0\u91D1\u6D41\u91CF\u8868(\u4E3B\u8868)",[u.EXAMPLE_COST_CENTER]:"\u6210\u672C\u4E2D\u5FC3\u7ED3\u6784(\u4E3B\u8868)",[u.EXAMPLE_INCOME_STATEMENT]:"\u5229\u6DA6\u8868(\u4E3B\u8868)",[u.EXAMPLE_PRODUCTION_VALUE]:"\u4EA7\u503C\u6570\u636E(\u4E3B\u8868)",[u.EXAMPLE_PROJECT_TRACKING]:"\u9879\u76EE\u8DDF\u8E2A(\u4E3B\u8868)",[u.EXAMPLE_BALANCE_SHEET]:"\u8D44\u4EA7\u8D1F\u503A\u8868(\u4E3B\u8868)",[u.NANHUA_NEW_ORDERS]:"\u5357\u534E\u65B0\u7B7E\u8BA2\u5355\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.NANHUA_PROJECT_TRACKING]:"\u5357\u534E\u9879\u76EE\u8DDF\u8E2A\u60C5\u51B5",[u.NANHUA_BIDDING_STATUS]:"\u5357\u534E\u62DB\u6295\u6807\u60C5\u51B5",[u.NANHUA_BUSINESS_INCOME]:"\u5357\u534E\u8425\u4E1A\u6536\u5165\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.NANHUA_ORDER_TO_INCOME]:"\u5357\u534E\u5F53\u5E74\u8BA2\u5355\u8F6C\u6536\u5165",[u.NANHUA_NON_MAIN_BUSINESS]:"\u5357\u534E\u975E\u4E3B\u8425\u4E1A\u52A1\u60C5\u51B5",[u.NANHUA_STOCK_ORDER_TO_INCOME]:"\u5357\u534E\u5B58\u91CF\u8BA2\u5355\u8F6C\u6536\u5165",[u.NANHUA_INVENTORY_STRUCTURE]:"\u5357\u534E\u5B58\u91CF\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.NANHUA_BID_FULFILLMENT]:"\u5357\u534E\u4E2D\u6807\u672A\u5C65\u7EA6\u60C5\u51B5",[u.NANHUA_MAIN_BUSINESS_COST]:"\u5357\u534E\u4E3B\u8425\u4E1A\u52A1\u6210\u672C\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.NANHUA_CONTRACT_INVENTORY]:"\u5357\u534E\u5728\u5EFA\u5DE5\u7A0B\u60C5\u51B5\uFF08\u5408\u540C\u5B58\u91CF\uFF09",[u.NANHUA_COST_PROVISION]:"\u5357\u534E\u6210\u672C\u8BA1\u63D0\u60C5\u51B5",[u.NANHUA_COST_CENTER_STRUCTURE]:"\u5357\u534E\u6210\u672C\u4E2D\u5FC3\u7ED3\u6784\u4E0E\u8D28\u91CF\uFF08\u6309\u5E74\u5EA6\u8BA1\u5212\u53E3\u5F84\u5206\u89E3\uFF09",[u.NANHUA_ANALYSIS_APPENDIX]:"\u5357\u534E\u5206\u6790\u9644\u5F55",[u.DEPARTMENT_COST_CENTER_ACTUAL]:"\u90E8\u95E8\u6210\u672C\u4E2D\u5FC3\u5B9E\u9645\u53D1\u751F\u60C5\u51B5",[u.NANHUA_DEPARTMENT_COST_INPUT]:"\u5357\u534E\u90E8\u95E8\u6210\u672C\u4E2D\u5FC3\u8BA1\u5165\u635F\u76CA\u60C5\u51B5",[u.NANHUA_BUSINESS_CONTRIBUTION_WITH_SELF_BUILT]:"\u5357\u534E\u4E3B\u8425\u4E1A\u52A1\u8FB9\u9645\u8D21\u732E\u7387\u7ED3\u6784\u4E0E\u8D28\u91CF\uFF08\u542B\u81EA\u5EFA\u9879\u76EE\uFF09",[u.NANHUA_BUSINESS_PROFIT_MARGIN_WITH_SELF_BUILT]:"\u5357\u534E\u4E3B\u8425\u4E1A\u52A1\u6BDB\u5229\u7387\u7ED3\u6784\u4E0E\u8D28\u91CF\uFF08\u542B\u81EA\u5EFA\u9879\u76EE\uFF09",[u.NANHUA_RECEIPT_STRUCTURE]:"\u5357\u534E\u6536\u6B3E\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.NANHUA_CONTRACT_INVENTORY_EVALUATION]:"\u5357\u534E\u5728\u5EFA\u5DE5\u7A0B\uFF08\u5408\u540C\u5B58\u91CF\uFF09",[u.NANHUA_MAIN_BUSINESS_NET_PROFIT]:"\u5357\u534E\u4E3B\u8425\u4E1A\u52A1\u51C0\u5229\u6DA6\u8D21\u732E\u60C5\u51B5",[u.NANHUA_NON_MAIN_BUSINESS_NET_PROFIT]:"\u5357\u534E\u975E\u4E3B\u8425\u4E1A\u52A1\u51C0\u5229\u6DA6\u8D21\u732E\u60C5\u51B5",[u.NANHUA_OVERDUE_RECEIVABLES]:"\u5357\u534E\u903E\u671F\u5E94\u6536\u8D26\u6B3E\u60C5\u51B5",[u.NANHUA_SELF_CONSTRUCTION_ANALYSIS]:"\u5357\u534E\u4E3B\u8425\u4E1A\u52A1\u4EA7\u503C\u81EA\u884C\u65BD\u5DE5\u60C5\u51B5\u5206\u6790",[u.NANHUA_BAD_DEBT_PROVISION]:"\u5357\u534E\u574F\u8D26\u51C6\u5907\u60C5\u51B5",[u.NANHUA_CONSTRUCTION_PLAN_EXECUTION]:"\u5357\u534E\u65BD\u5DE5\u8BA1\u5212\u6267\u884C\u60C5\u51B5",[u.NANHUA_CONSTRUCTION_EXECUTION_STATUS]:"\u5357\u534E\u65BD\u5DE5\u6267\u884C\u60C5\u51B5",[u.NANHUA_MAJOR_INVESTMENT]:"\u5357\u534E\u5E74\u5EA6\u91CD\u5927\u6295\u8D44\u60C5\u51B5",[u.TUOYUAN_NEW_ORDER_STRUCTURE]:"\u62D3\u6E90\u65B0\u7B7E\u8BA2\u5355\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.TUOYUAN_PROJECT_TRACKING]:"\u62D3\u6E90\u9879\u76EE\u8DDF\u8E2A\u60C5\u51B5",[u.TUOYUAN_BIDDING_STATUS]:"\u62D3\u6E90\u62DB\u6295\u6807\u60C5\u51B5",[u.MAIN_BUSINESS_INCOME_BREAKDOWN]:"\u4E3B\u8425\u4E1A\u52A1\u6536\u5165\u5206\u89E3\u60C5\u51B5",[u.TUOYUAN_ORDER_TO_INCOME]:"\u62D3\u6E90\u5F53\u5E74\u8BA2\u5355\u8F6C\u6536\u5165",[u.STOCK_ORDER_TO_INCOME]:"\u62D3\u6E90\u5B58\u91CF\u8BA2\u5355\u8F6C\u6536\u5165",[u.TUOYUAN_NON_MAIN_BUSINESS]:"\u62D3\u6E90\u975E\u4E3B\u8425\u4E1A\u52A1\u60C5\u51B5",[u.TUOYUAN_INVENTORY_STRUCTURE]:"\u62D3\u6E90\u5B58\u91CF\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.TUOYUAN_BID_FULFILLMENT]:"\u62D3\u6E90\u4E2D\u6807\u672A\u5C65\u7EA6\u60C5\u51B5",[u.TUOYUAN_INVENTORY_IN_PROGRESS]:"\u62D3\u6E90\u5728\u4EA7\u60C5\u51B5",[u.TUOYUAN_INVENTORY_STATUS]:"\u62D3\u6E90\u5E93\u5B58\u60C5\u51B5",[u.TUOYUAN_MAIN_BUSINESS_COST_STRUCTURE_QUALITY]:"\u62D3\u6E90\u4E3B\u8425\u4E1A\u52A1\u6210\u672C\u7ED3\u6784\u4E0E\u8D28\u91CF\uFF08\u6309\u5E74\u5EA6\u53E3\u5F84\u5206\u89E3\uFF09",[u.TUOYUAN_COST_ESTIMATION]:"\u62D3\u6E90\u6210\u672C\u6682\u4F30\u5165\u5E93\u548C\u8BA1\u63D0\u60C5\u51B5",[u.TUOYUAN_COST_CENTER_PROFIT_LOSS]:"\u62D3\u6E90\u6210\u672C\u4E2D\u5FC3\u8BA1\u5165\u635F\u76CA\u60C5\u51B5",[u.TUOYUAN_MAIN_BUSINESS_CONTRIBUTION_RATE]:"\u62D3\u6E90\u4E3B\u8425\u4E1A\u52A1\u8FB9\u9645\u8D21\u732E\u7387\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.TUOYUAN_MAIN_BUSINESS_PROFIT_MARGIN]:"\u62D3\u6E90\u4E3B\u8425\u4E1A\u52A1\u6BDB\u5229\u7387\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.TUOYUAN_MAIN_BUSINESS_NET_PROFIT_CONTRIBUTION]:"\u62D3\u6E90\u4E3B\u8425\u4E1A\u52A1\u51C0\u5229\u6DA6\u8D21\u732E\u60C5\u51B5",[u.PAYMENT_STRUCTURE_QUALITY]:"\u6536\u6B3E\u7ED3\u6784\u4E0E\u8D28\u91CF",[u.TUOYUAN_ACCOUNTS_RECEIVABLE]:"\u62D3\u6E90\u5E94\u6536\u8D26\u6B3E\u60C5\u51B5",[u.TUOYUAN_OVERDUE_RECEIVABLES]:"\u62D3\u6E90\u903E\u671F\u5E94\u6536\u8D26\u6B3E\u60C5\u51B5",[u.TUOYUAN_BAD_DEBT_PROVISION]:"\u62D3\u6E90\u574F\u8D26\u51C6\u5907\u60C5\u51B5",[u.TUOYUAN_CONSTRUCTION_PLAN_EXECUTION]:"\u62D3\u6E90\u65BD\u5DE5\u8BA1\u5212\u6267\u884C\u60C5\u51B5",[u.TUOYUAN_MAJOR_INVESTMENT]:"\u62D3\u6E90\u5E74\u5EA6\u91CD\u5927\u6295\u8D44\u60C5\u51B5",[u.TUOYUAN_MAIN_BUSINESS_PRODUCTION_VALUE_SELF_CONSTRUCTION]:"\u62D3\u6E90\u4E3B\u8425\u4E1A\u52A1\u4EA7\u503C--\u81EA\u884C\u65BD\u5DE5\u60C5\u51B5\u5206\u6790",[u.TUOYUAN_CONSTRUCTION_EXECUTION_STATUS]:"\u62D3\u6E90\u65BD\u5DE5\u6267\u884C\u60C5\u51B5"};function P(_){return L[_]||`\u6A21\u5757${_}`}async function y(_,r,N,t){var s;try{const n=(s=d().userInfo)==null?void 0:s.id;if(!n)throw new Error("\u7528\u6237\u4FE1\u606F\u4E0D\u5B58\u5728");console.log("\u4E0A\u4F20\u6587\u4EF6\u4FE1\u606F:",{fileName:_.name,fileSize:_.size,fileType:_.type,moduleId:r,period:N,userId:n,description:t});const C=new FormData;C.append("file",_),C.append("moduleId",r.toString()),C.append("period",N),C.append("userId",n.toString()),t&&C.append("description",t);const O=await fetch("http://47.111.95.19:3000/files/upload",{method:"POST",body:C});if(console.log("\u4E0A\u4F20\u54CD\u5E94\u72B6\u6001:",O.status),!O.ok){const I=await O.text();throw console.error("\u4E0A\u4F20\u5931\u8D25\u54CD\u5E94:",I),new Error("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")}const S=await O.json();return console.log("\u4E0A\u4F20\u6210\u529F\u54CD\u5E94:",S),S.data}catch(T){throw console.error("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25:",T),T}}async function h(_,r){try{const N=await fetch(`http://47.111.95.19:3000/files/attachments/${_}/${r}`);if(!N.ok)throw new Error("\u83B7\u53D6\u9644\u4EF6\u5217\u8868\u5931\u8D25");return(await N.json()).data||[]}catch(N){return console.error("\u83B7\u53D6\u9644\u4EF6\u5217\u8868\u5931\u8D25:",N),[]}}async function x(_){var r;try{const t=(r=d().userInfo)==null?void 0:r.id;if(!t)throw new Error("\u7528\u6237\u4FE1\u606F\u4E0D\u5B58\u5728");if(!(await fetch(`http://47.111.95.19:3000/files/delete/${_}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t})})).ok)throw new Error("\u6587\u4EF6\u5220\u9664\u5931\u8D25");return!0}catch(N){return console.error("\u6587\u4EF6\u5220\u9664\u5931\u8D25:",N),!1}}async function Y(_,r){var N,t;try{const s=await fetch(`http://47.111.95.19:3000/forms/submission/${_}/${r}`);if(s.status===404)return{remarks:"",suggestions:""};if(!s.ok)throw new Error("\u83B7\u53D6\u5907\u6CE8\u4FE1\u606F\u5931\u8D25");const T=await s.json();return{remarks:((N=T.data)==null?void 0:N.remarks)||"",suggestions:((t=T.data)==null?void 0:t.suggestions)||""}}catch(s){return console.error("\u83B7\u53D6\u5907\u6CE8\u4FE1\u606F\u5931\u8D25:",s),{remarks:"",suggestions:""}}}async function Du(_,r){return await Y(_,r)}const v={class:"mt-8 bg-white border border-gray-200 rounded-lg shadow-sm"},H={class:"border-b border-gray-200 px-6 py-4 bg-gray-50"},V={class:"flex items-center justify-between"},w={class:"inline-flex items-center px-3 py-1 rounded-md text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200"},G={class:"p-6 space-y-6"},X={class:"border border-gray-200 rounded-lg"},k={class:"p-4"},K={class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors duration-200"},J={class:"space-y-4"},W={class:"text-sm text-gray-600"},j={for:"file-upload",class:"relative cursor-pointer font-medium text-blue-600 hover:text-blue-500"},$={class:"text-xs text-blue-600 mt-1"},z={key:0,class:"mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200"},Q={class:"flex items-center justify-between"},q={class:"text-sm font-medium text-gray-900"},Z={class:"text-xs text-gray-500"},uu=["disabled"],Eu={key:0,class:"border border-gray-200 rounded-lg"},eu={class:"divide-y divide-gray-200"},Nu={class:"flex items-center justify-between"},tu={class:"flex-1 min-w-0"},_u={class:"flex items-center space-x-3"},Au={class:"text-sm font-medium text-gray-900 truncate"},su={class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800"},ou={class:"mt-1 text-xs text-gray-500 space-x-4"},ru={key:0,class:"mt-2 text-xs text-gray-600 bg-gray-50 rounded px-3 py-1"},Tu={class:"flex items-center space-x-2 ml-4"},Cu=["href"],nu=["onClick"],Su={class:"border border-gray-200 rounded-lg"},Uu={class:"p-4"},Ou={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Iu=["value"],au=["value"],Fu=g({__name:"FormAttachmentAndRemarks",props:{moduleId:{},period:{},remarks:{},suggestions:{}},emits:["update:remarks","update:suggestions"],setup(_,{emit:r}){const N=_,t=l(null),s=l(!1),T=l([]),n=l(null),C=m(()=>P(N.moduleId)),O=A=>{const e=A.target;e.files&&e.files.length>0&&(t.value=e.files[0])},S=async()=>{if(!!t.value){s.value=!0;try{await y(t.value,N.moduleId,N.period,`${C.value}\u76F8\u5173\u6587\u4EF6`),t.value=null,n.value&&(n.value.value=""),await I(),alert("\u6587\u4EF6\u4E0A\u4F20\u6210\u529F")}catch(A){console.error("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25:",A),alert("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")}finally{s.value=!1}}},I=async()=>{try{T.value=await h(N.moduleId,N.period)}catch(A){console.error("\u52A0\u8F7D\u9644\u4EF6\u5217\u8868\u5931\u8D25:",A)}},D=async A=>{if(!!confirm("\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u4E2A\u6587\u4EF6\u5417\uFF1F"))try{await x(A)&&(await I(),alert("\u6587\u4EF6\u5220\u9664\u6210\u529F"))}catch(e){console.error("\u6587\u4EF6\u5220\u9664\u5931\u8D25:",e),alert("\u6587\u4EF6\u5220\u9664\u5931\u8D25")}},R=A=>{if(A===0)return"0 Bytes";const e=1024,o=["Bytes","KB","MB","GB"],F=Math.floor(Math.log(A)/Math.log(e));return parseFloat((A/Math.pow(e,F)).toFixed(2))+" "+o[F]},c=A=>new Date(A).toLocaleString("zh-CN");return p(()=>N.period,()=>{I()}),f(()=>{I()}),(A,e)=>(B(),a("div",v,[E("div",H,[E("div",V,[e[2]||(e[2]=E("h3",{class:"text-lg font-semibold text-gray-900"},"\u9644\u4EF6\u548C\u5907\u6CE8",-1)),E("span",w," \u5171 "+U(T.value.length)+" \u4E2A\u9644\u4EF6 ",1)])]),E("div",G,[E("div",X,[e[6]||(e[6]=E("div",{class:"border-b border-gray-200 px-4 py-3 bg-gray-50"},[E("h4",{class:"text-sm font-medium text-gray-900"},"\u6587\u4EF6\u4E0A\u4F20")],-1)),E("div",k,[E("div",K,[E("div",J,[E("div",W,[E("label",j,[e[3]||(e[3]=E("span",null,"\u70B9\u51FB\u9009\u62E9\u6587\u4EF6",-1)),E("input",{id:"file-upload",ref_key:"fileInput",ref:n,type:"file",onChange:O,class:"sr-only",accept:".pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif,.txt"},null,544)]),e[4]||(e[4]=E("span",{class:"ml-1"},"\u6216\u62D6\u62FD\u6587\u4EF6\u5230\u6B64\u5904",-1))]),e[5]||(e[5]=E("p",{class:"text-xs text-gray-500"},"\u652F\u6301\u683C\u5F0F\uFF1APDF\u3001DOC\u3001DOCX\u3001XLS\u3001XLSX\u3001JPG\u3001PNG\u3001GIF\u3001TXT",-1)),E("p",$,"\u8BF7\u4E0A\u4F20\uFF1A"+U(C.value)+"\u76F8\u5173\u6587\u4EF6",1)])]),t.value?(B(),a("div",z,[E("div",Q,[E("div",null,[E("p",q,U(t.value.name),1),E("p",Z,"\u6587\u4EF6\u5927\u5C0F\uFF1A"+U(R(t.value.size)),1)]),E("button",{onClick:S,disabled:s.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors duration-200"},U(s.value?"\u4E0A\u4F20\u4E2D...":"\u786E\u8BA4\u4E0A\u4F20"),9,uu)])])):i("",!0)])]),T.value.length>0?(B(),a("div",Eu,[e[7]||(e[7]=E("div",{class:"border-b border-gray-200 px-4 py-3 bg-gray-50"},[E("h4",{class:"text-sm font-medium text-gray-900"},"\u5DF2\u4E0A\u4F20\u6587\u4EF6")],-1)),E("div",eu,[(B(!0),a(M,null,b(T.value,o=>(B(),a("div",{key:o.id,class:"p-4 hover:bg-gray-50 transition-colors duration-150"},[E("div",Nu,[E("div",tu,[E("div",_u,[E("h5",Au,U(o.original_name),1),E("span",su,U(R(o.file_size)),1)]),E("div",ou,[E("span",null,"\u4E0A\u4F20\u65F6\u95F4\uFF1A"+U(c(o.uploaded_at)),1),E("span",null,"\u4E0A\u4F20\u4EBA\uFF1A"+U(o.uploaded_by),1)]),o.description?(B(),a("div",ru,U(o.description),1)):i("",!0)]),E("div",Tu,[E("a",{href:`http://47.111.95.19:3000/files/download/${o.id}`,target:"_blank",class:"px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-150"}," \u4E0B\u8F7D ",8,Cu),E("button",{onClick:F=>D(o.id),class:"px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-150"}," \u5220\u9664 ",8,nu)])])]))),128))])])):i("",!0),E("div",Su,[e[10]||(e[10]=E("div",{class:"border-b border-gray-200 px-4 py-3 bg-gray-50"},[E("h4",{class:"text-sm font-medium text-gray-900"},"\u7BA1\u7406\u5206\u6790\u4E0E\u5EFA\u8BAE")],-1)),E("div",Uu,[E("div",Ou,[E("div",null,[e[8]||(e[8]=E("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"\u7BA1\u7406\u5206\u6790",-1)),E("textarea",{value:A.remarks,onInput:e[0]||(e[0]=o=>A.$emit("update:remarks",o.target.value)),rows:"5",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",placeholder:"\u8981\u6C42\u586B\u5199\u5BF9\u5F53\u524D\u6570\u636E\u7684\u603B\u7ED3\u548C\u8BF4\u660E"},null,40,Iu)]),E("div",null,[e[9]||(e[9]=E("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"\u5EFA\u8BAE\u4FE1\u606F",-1)),E("textarea",{value:A.suggestions,onInput:e[1]||(e[1]=o=>A.$emit("update:suggestions",o.target.value)),rows:"5",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",placeholder:"\u8981\u6C42\u586B\u5199\u76F8\u5173\u6539\u8FDB\u610F\u89C1\u548C\u4F18\u5316\u63AA\u65BD\u7B49"},null,40,au)])])])])])]))}});export{u as M,Fu as _,Du as l,lu as r};
